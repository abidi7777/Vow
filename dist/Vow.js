var D=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)},n=(i,t,e)=>(D(i,t,"read from private field"),e?e.call(i):t.get(i)),p=(i,t,e,s)=>(D(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e);var a=Object.freeze({PENDING:"<pending>",FULFILLED:"<fulfilled>",REJECTED:"<rejected>"}),g=()=>{};var E=i=>typeof i=="function",F=i=>i&&typeof i.then=="function",S=({controlledVow:i,sideEffect:t})=>{let e=t();F(e)?e.then(s=>i.onFulfill(s),s=>i.onReject(s)):i.onFulfill()};var o,h,f,u,c=class{constructor(t){o.set(this,[]);h.set(this,a.PENDING);f.set(this,void 0);u.set(this,void 0);setTimeout(()=>{try{t(this.onFulfill.bind(this),this.onReject.bind(this))}catch(e){this.onReject(e)}},0)}then(t,e){let s=new c(g);return n(this,o).push([s,t,e]),n(this,h)!==a.PENDING&&this.propagateStateChange(),s}catch(t){return this.then(void 0,t)}finally(t){let e=new c(g);return n(this,h)!==a.PENDING&&t(),n(this,o).push([e,void 0,void 0,t]),e}static resolve(t){return new c(e=>e(t))}static reject(t){return new c((e,s)=>s(t))}get reason(){return n(this,f)}get value(){return n(this,u)}get state(){return n(this,h)}onFulfill(t){n(this,h)===a.PENDING&&(p(this,h,a.FULFILLED),p(this,u,t),this.propagateStateChange())}onReject(t){n(this,h)===a.PENDING&&(p(this,h,a.REJECTED),p(this,f,t),this.propagateStateChange())}propagateStateChange(){n(this,h)===a.FULFILLED?this.propagateFulfilledState():n(this,h)===a.REJECTED&&this.propagateRejectedState(),p(this,o,[])}propagateFulfilledState(){n(this,o).forEach(([t,e,,s])=>{if(E(s))S({controlledVow:t,sideEffect:s});else if(E(e)){let l=e(n(this,u));F(l)?l.then(r=>t.onFulfill(r),r=>t.onReject(r)):t.onFulfill(l)}else t.onFulfill(n(this,u))})}propagateRejectedState(){n(this,o).forEach(([t,,e,s])=>{if(E(s))S({controlledVow:t,sideEffect:s});else if(E(e)){let l=e(n(this,f));F(l)?l.then(r=>t.onFulfill(r),r=>t.onReject(r)):t.onFulfill()}else t.onReject(n(this,f))})}},j=c;o=new WeakMap,h=new WeakMap,f=new WeakMap,u=new WeakMap;typeof window!="undefined"&&(window.Vow=j);var N=j;export{N as default};
